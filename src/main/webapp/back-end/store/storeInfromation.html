<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>Document</title>
<link rel="stylesheet" href="../../css/storealter1.css">
<link rel="stylesheet" href="../../css/header.css" />
</style>
<link 
	href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/css/bootstrap.min.css"
	rel="stylesheet"
	integrity="sha384-+0n0xVW2eSR5OomGNYDnhzAbDsOXxcvSN1TPprVMTNDbiYZCxYbOOl7+AMvyTG2x"
	crossorigin="anonymous" />
<script
	src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.1/dist/js/bootstrap.bundle.min.js"
	integrity="sha384-gtEjrD/SeCtmISkJkNUaaKMoLD0//ElJ19smozuHV6z3Iehds+3Ulb9Bn9Plx0x4"
	crossorigin="anonymous"></script>
</head>
<body style="background-color: rgb(216, 208, 208)">
	<div id="xxx"></div>

	<div class="contain">
		<aside class="aside">
			<p id="p1">廠商後台</p>
			<div class="div_func">
				<div>
					<a class="edit_store" type="button">店家資訊</a>
				</div>
				<div>
					<a class="edit_store" type="button"
          href="/TGA103G1/back-end/store/storealter.html">店家頁面</a>
				</div>
				<div>
					<a class="manager_item" type="button"
						href="../product/productlist.jsp">商品管理</a>
				</div>
				<div>
					<a class="edit_item" type="button"
						href="/TGA103G1/back-end/store/storeOrder.html">商家訂單內容</a>
				</div>

			</div>
		</aside>
		<main class="main">
			<div class="container">
        <form class="row g-3">
          <div class="col-12">
            <h1>店家資訊</h1>
          </div>
          <div class="col-md-6">
            <label for="storeName" class="form-label" >店家名稱</label>
            <input type="tetx" class="form-control" id="storeName" readonly>
          </div>
          <div class="col-md-6">
            <label for="storeType" class="form-label">店家類型 </label>
            <select id="storeType" name="theme_id" class="form-select">
							<option value="1">Bistro</option>
							<option value="2">Cocktail Bar</option>
							<option value="3">Whisky Bar</option>
						</select>
          </div>
          <div class="col-12">
            <label for="storeAddress" class="form-label">Address</label>
            <input type="text" class="form-control" id="storeAddress">
          </div>
          <div class="col-6">
           
            <label for="storePhone" class="form-label">電話</label>
            <input type="text" class="form-control" id="storePhone">
          </div>
          <div class="col-6">
            <label for="storeEmail" class="form-label">email</label>
            <input type="email" class="form-control" id="storeEmail">
          </div>

          
          <div class="col-12">
            <button type="submit" class="btn btn-primary" style="background-color: rgb(129, 93, 65)">更新</button>
          </div>
        </form>
        </div>
      </div>
		</main>
	</div>

	</div>
	<script>
   
   function includeHTML() {
        const xxx = document.querySelector("#xxx");
        fetch("/TGA103G1/com/header.html")
          .then((resp) => resp.text())
          .then((content) => {
            xxx.innerHTML = content;
            changelog();
            logout();
            changeTheme()
            const username = document.querySelector("#account");
            const password = document.querySelector("#password");
            const errMsg = document.querySelector("#errMsg");
            document.getElementById("btn1").addEventListener("click", () => {
              fetch("/TGA103G1/StoreLogin", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({
                  account: username.value,
                  password: password.value,
                }),
              })
                .then((resp) => resp.json())
                .then((body) => {
                  errMsg.textContent = "";
                  const { successful, message } = body;
                  if (successful) {
                    const { account, password } = body;
                    sessionStorage.setItem("account", account);
                    sessionStorage.setItem("password", password);
                    location = "/TGA103G1/ShowProduct";
                  } else {
                    errMsg.textContent = message;
                  }
                });
            });
          });
      }
      includeHTML();

  
//登出鈕
function changelog(){
			
			if(sessionStorage.getItem("account")){
            document.querySelector("#login").style.display='none'
            document.querySelector("#logout").style.display='block'
            document.querySelector("#loginbox").style.display = "none";
            document.querySelector("#normal").style.display = "block";
          }
		}

//登出
      function logout(){
        document.querySelector("#logout").addEventListener("click", function(){
            sessionStorage.removeItem("account")
          })
      }
	//點擊theme_id
	function changeTheme(){
let allthemeid =  document.querySelectorAll(".theme_id");
allthemeid.forEach(function(e){
  e.addEventListener("click", function(e){
		let id = e.target.getAttribute("data-themid");
		sessionStorage.setItem("themeId",id)
  })
})
}
//取回資訊
let account = sessionStorage.getItem("account")
let storeName = document.querySelector("#storeName")
let storePhone = document.querySelector("#storePhone")
let storeAddress = document.querySelector("#storeAddress")
let storeType = document.querySelector("#storeType")
let storeEmail = document.querySelector("#storeEmail")

fetch('/TGA103G1/ShowStoreInformation', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        account:account
      }),
    })
      .then(resp => resp.json() )
      .then(body => {
        console.log(body);
        storeName.value = body.account,
        storePhone.value = body.phone,
        storeAddress.value = body.address,
        storeType.value = body.theme_id,
        storeEmail.value = body.email

      });


    </script>

</body>
</html>
